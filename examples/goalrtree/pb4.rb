require_relative 'GoalRtree'

# 2D version of the Cubicles scenario from OMPL

# TODO add columns
# TODO connect bottom

# Top level Y = -9.75
environment_top = [
  # Rects [x,z,w,h]
  [-483.17, -209.91,  306.31 - -483.17, 486.88 - -209.91],
  [-483.17,  -49.08, -349.92 - -483.17, -20.58 -  -49.08],
  [  74.59,  266.88,   98.59 -   74.59, 486.88 -  266.88],
  [-245.04,   45.34,  -98.54 - -245.04,  80.34 -   45.34],
  [ -98.54, -107.83,  -71.04 -  -98.54, 323.91 -  -71.04],
  [ -71.04,   37.12,   71.45 -  -71.04,  72.37 -   37.12],
  [  71.45, -209.91,   89.85 -   71.45,  72.37 - -209.91],
  [  89.85,    6.75,  306.31 -   89.85,  30.67 -    6.75]
]

# Bottom level Y = 123.75
environment_bottom = [
  [ 53.16, -230.12, 319.61 - 53.16,  531.87 - -230.12],
  [ 72.25, -230.12, 301.81 - 72.25, -203.89 - -230.12],
  [ 53.16, -230.12,  72.25 - 53.16,  531.87 - -230.12],
  [ 73.03,  476.75, 307.78 - 73.03,  531.87 -  476.75],
  [301.81, -230.12, 319.61 - 301.81, 531.87 - -230.12]
]

goals = [
  Point.new(-410,  300),
  Point.new(-440, -150),
  Point.new(-140,  268),
  Point.new(-150,  -35),
  Point.new(  40,  430),
  Point.new( -20,  165),
  Point.new(  -4,  -40),
  Point.new( 230,  370),
  Point.new( 265,  107),
  Point.new( 135,   85),
  Point.new( 220, -150)
]

tree = GoalRtree.generate('pb4_top', environment_top, goals)
puts tree

abort('Tree is different from expected') if tree !=
'global: [-483.17, -209.91, 1099.5900000000001, 696.79]
  intermediate: [-483.17, 80.34, 384.63, 406.53999999999996]
    local: [-483.17, 287.12000000000006, 133.25, 199.75999999999993]
      centroid: (-416.545, 387.0)
      goal: (-410, 300)
    local: [-245.04, 80.34, 146.5, 206.78000000000006]
      centroid: (-171.79, 183.73000000000002)
      goal: (-140, 268)
  intermediate: [-483.17, -209.91, 384.63, 189.32999999999998]
    local: [-483.17, -209.91, 133.25, 102.08]
      centroid: (-416.545, -158.87)
      goal: (-440, -150)
    local: [-245.04, -49.08, 146.5, 28.5]
      centroid: (-171.79, -34.83)
      goal: (-150, -35)
  intermediate: [-71.04, 72.37, 377.35, 414.51]
    local: [-71.04, 287.12000000000006, 142.49, 199.75999999999993]
      centroid: (0.2049999999999983, 387.0)
      goal: (40, 430)
    local: [-71.04, 72.37, 142.49, 194.51]
      centroid: (0.2049999999999983, 169.625)
      goal: (-20, 165)
    local: [98.59, 72.37, 207.72, 194.51]
      centroid: (202.45, 169.625)
      specific: [200, 96, 106.31, 170.88]
        goal: (265, 107)
      specific: [98.59, 72.37, 101.41, 23.629999999999995]
        goal: (135, 85)
    local: [98.59, 266.88, 207.72, 220.0]
      centroid: (202.45, 376.88)
      goal: (230, 370)
  intermediate: [-71.04, -107.83, 142.49, 144.95]
    local: [-71.04, -107.83, 142.49, 144.95]
      centroid: (0.2049999999999983, -35.355000000000004)
      goal: (-4, -40)
  intermediate: [89.85, -209.91, 216.46, 216.66]
    local: [89.85, -209.91, 216.46, 216.66]
      centroid: (198.07999999999998, -101.58)
      goal: (220, -150)'